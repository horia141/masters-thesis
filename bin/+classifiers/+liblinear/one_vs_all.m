classdef one_vs_all < classifier
    properties (GetAccess=public,SetAccess=immutable)
        model_weights;
        method_type_fn;
        reg_param;
        num_threads;
    end
    
    methods (Access=public)
        function [obj] = one_vs_all(train_sample,class_info,method_type_fn,reg_param,num_threads,logger)
            assert(tc.dataset_record(train_sample));
            assert(tc.scalar(class_info));
            assert(tc.classification_info(class_info));
            assert(tc.scalar(method_type_fn));
            assert(tc.function_h(method_type_fn));
            assert(tc.one_of(method_type_fn,@classifiers.liblinear.one_vs_all.logistic_primal_regL1,...
                                            @classifiers.liblinear.one_vs_all.logistic_primal_regL2,...
                                            @classifiers.liblinear.one_vs_all.logistic_dual_regL2,...
                                            @classifiers.liblinear.one_vs_all.support_primal_regL1,...
                                            @classifiers.liblinear.one_vs_all.support_primal_regL2,...
                                            @classifiers.liblinear.one_vs_all.support_dual_lossL1,...
                                            @classifiers.liblinear.one_vs_all.support_dual_lossL2));
            assert(tc.scalar(reg_param));
            assert(tc.number(reg_param));
            assert(reg_param > 0);
            assert(tc.scalar(num_threads));
            assert(tc.natural(num_threads));
            assert(num_threads > 0);
            assert(tc.scalar(logger));
            assert(tc.logging_logger(logger));
            assert(logger.active);
            
            method_code = method_type_fn();
            model_weights_t = classifiers.liblinear.x_do_train_one_vs_all(train_sample,class_info,method_code,reg_param,num_threads,logger.new_classifier('Training each classifier'));
            
            input_geometry = dataset.geometry(train_sample);
            
            obj = obj@classifier(input_geometry,class_info.labels,logger);
            obj.model_weights = model_weights_t;
            obj.method_type_fn = method_type_fn;
            obj.reg_param = reg_param;
            obj.num_threads = num_threads;
        end
    end
    
    methods (Access=protected)
        function [labels_idx_hat,labels_confidence] = do_classify(obj,sample,logger)
            method_code = obj.method_type_fn();
            classes_decisions = classifiers.liblinear.x_do_classify(sample,obj.model_weights,method_code,obj.reg_param,logger.new_classifier('Classifying with each classifier'));
            classes_probs = 1 ./ (1 + 2.71314 .^ (-classes_decisions'));
            
            logger.message('Determining most probable class.');
            
            [max_probs,max_probs_idx] = max(classes_probs,[],2);
            
            labels_idx_hat = max_probs_idx';
            labels_confidence = bsxfun(@rdivide,classes_probs,max_probs)';
        end
    end
    
    methods (Static,Access=public)
        function [o] = logistic_primal_regL1()
            o = 6;
        end
        
        function [o] = logistic_primal_regL2()
            o = 0;
        end
        
        function [o] = logistic_dual_regL2()
            o = 7;
        end
        
        function [o] = support_primal_regL1()
            o = 5;
        end
        
        function [o] = support_primal_regL2()
            o = 2;
        end
                
        function [o] = support_dual_lossL1()
            o = 3;
        end
        
        function [o] = support_dual_lossL2()
            o = 1;
        end
    end
    
    methods (Static,Access=public)
        function test(display)
            fprintf('Testing "classifiers.liblinear.one_vs_all".\n');
            
            fprintf('  Proper construction.\n');
            
            fprintf('    With L1 regularized logistic regression in primal form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s,ci] = utilstest.classifier_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s,ci,@classifiers.liblinear.one_vs_all.logistic_primal_regL1,1,1,log);

            assert(tc.matrix(cl.model_weights));
            assert(tc.same(size(cl.model_weights),[3 3]));
            assert(tc.number(cl.model_weights));
            assert(tc.same(cl.method_type_fn,@classifiers.liblinear.one_vs_all.logistic_primal_regL1));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) >= 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) < 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) < 0,201:300));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) < 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) >= 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) < 0,201:300));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) < 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) < 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) >= 0,201:300));
            assert(cl.reg_param == 1);
            assert(cl.num_threads == 1);
            assert(tc.same(cl.input_geometry,2));
            assert(tc.same(cl.saved_labels,{'1' '2' '3'}));
            assert(cl.saved_labels_count == 3);
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 300\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L1-regularized logistic regression in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 600\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n'))));
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('    With L2 regularized logistic regression in primal form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s,ci] = utilstest.classifier_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s,ci,@classifiers.liblinear.one_vs_all.logistic_primal_regL2,1,1,log);

            assert(tc.matrix(cl.model_weights));
            assert(tc.same(size(cl.model_weights),[3 3]));
            assert(tc.number(cl.model_weights));
            assert(tc.same(cl.method_type_fn,@classifiers.liblinear.one_vs_all.logistic_primal_regL2));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) >= 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) < 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) < 0,201:300));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) < 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) >= 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) < 0,201:300));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) < 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) < 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) >= 0,201:300));
            assert(cl.reg_param == 1);
            assert(cl.num_threads == 1);
            assert(tc.same(cl.input_geometry,2));
            assert(tc.same(cl.saved_labels,{'1' '2' '3'}));
            assert(cl.saved_labels_count == 3);
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 300\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized logistic regression in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 600\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n'))));
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('    With L2 regularized logistic regression in dual form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s,ci] = utilstest.classifier_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s,ci,@classifiers.liblinear.one_vs_all.logistic_dual_regL2,1,1,log);

            assert(tc.matrix(cl.model_weights));
            assert(tc.same(size(cl.model_weights),[3 3]));
            assert(tc.number(cl.model_weights));
            assert(tc.same(cl.method_type_fn,@classifiers.liblinear.one_vs_all.logistic_dual_regL2));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) >= 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) < 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) < 0,201:300));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) < 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) >= 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) < 0,201:300));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) < 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) < 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) >= 0,201:300));
            assert(cl.reg_param == 1);
            assert(cl.num_threads == 1);
            assert(tc.same(cl.input_geometry,2));
            assert(tc.same(cl.saved_labels,{'1' '2' '3'}));
            assert(cl.saved_labels_count == 3);
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 300\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized logistic regression in dual form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 600\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n'))));
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('    With L1-regularized L2-loss support vector classification in primal form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s,ci] = utilstest.classifier_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s,ci,@classifiers.liblinear.one_vs_all.support_primal_regL1,1,1,log);

            assert(tc.matrix(cl.model_weights));
            assert(tc.same(size(cl.model_weights),[3 3]));
            assert(tc.number(cl.model_weights));
            assert(tc.same(cl.method_type_fn,@classifiers.liblinear.one_vs_all.support_primal_regL1));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) >= 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) < 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) < 0,201:300));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) < 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) >= 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) < 0,201:300));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) < 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) < 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) >= 0,201:300));
            assert(cl.reg_param == 1);
            assert(cl.num_threads == 1);
            assert(tc.same(cl.input_geometry,2));
            assert(tc.same(cl.saved_labels,{'1' '2' '3'}));
            assert(cl.saved_labels_count == 3);
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 300\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L1-regularized L2-loss support vector classification in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 600\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n'))));
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('    With L1-regularized L2-loss support vector classification in primal form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s,ci] = utilstest.classifier_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s,ci,@classifiers.liblinear.one_vs_all.support_primal_regL2,1,1,log);

            assert(tc.matrix(cl.model_weights));
            assert(tc.same(size(cl.model_weights),[3 3]));
            assert(tc.number(cl.model_weights));
            assert(tc.same(cl.method_type_fn,@classifiers.liblinear.one_vs_all.support_primal_regL2));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) >= 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) < 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) < 0,201:300));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) < 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) >= 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) < 0,201:300));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) < 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) < 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) >= 0,201:300));
            assert(cl.reg_param == 1);
            assert(cl.num_threads == 1);
            assert(tc.same(cl.input_geometry,2));
            assert(tc.same(cl.saved_labels,{'1' '2' '3'}));
            assert(cl.saved_labels_count == 3);
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 300\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized L2-loss support vector classification in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 600\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n'))));
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('    With L2-regularized L1-loss support vector classification in dual form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s,ci] = utilstest.classifier_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s,ci,@classifiers.liblinear.one_vs_all.support_dual_lossL1,1,1,log);

            assert(tc.matrix(cl.model_weights));
            assert(tc.same(size(cl.model_weights),[3 3]));
            assert(tc.number(cl.model_weights));
            assert(tc.same(cl.method_type_fn,@classifiers.liblinear.one_vs_all.support_dual_lossL1));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) >= 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) < 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) < 0,201:300));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) < 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) >= 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) < 0,201:300));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) < 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) < 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) >= 0,201:300));
            assert(cl.reg_param == 1);
            assert(cl.num_threads == 1);
            assert(tc.same(cl.input_geometry,2));
            assert(tc.same(cl.saved_labels,{'1' '2' '3'}));
            assert(cl.saved_labels_count == 3);
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 300\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized L1-loss support vector classification in dual form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 600\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n'))));
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('    With L2-regularized L2-loss support vector classification in dual form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s,ci] = utilstest.classifier_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s,ci,@classifiers.liblinear.one_vs_all.support_dual_lossL2,1,1,log);

            assert(tc.matrix(cl.model_weights));
            assert(tc.same(size(cl.model_weights),[3 3]));
            assert(tc.number(cl.model_weights));
            assert(tc.same(cl.method_type_fn,@classifiers.liblinear.one_vs_all.support_dual_lossL2));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) >= 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) < 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) < 0,201:300));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) < 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) >= 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) < 0,201:300));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) < 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) < 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) >= 0,201:300));
            assert(cl.reg_param == 1);
            assert(cl.num_threads == 1);
            assert(tc.same(cl.input_geometry,2));
            assert(tc.same(cl.saved_labels,{'1' '2' '3'}));
            assert(cl.saved_labels_count == 3);
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 300\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized L2-loss support vector classification in dual form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 600\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n'))));
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('    With multiple worker threads.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s,ci] = utilstest.classifier_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s,ci,@classifiers.liblinear.one_vs_all.support_primal_regL2,1,3,log);

            assert(tc.matrix(cl.model_weights));
            assert(tc.same(size(cl.model_weights),[3 3]));
            assert(tc.number(cl.model_weights));
            assert(tc.same(cl.method_type_fn,@classifiers.liblinear.one_vs_all.support_primal_regL2));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) >= 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) < 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,1) < 0,201:300));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) < 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) >= 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,2) < 0,201:300));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) < 0,1:100));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) < 0,101:200));
            assert(tc.checkf(@(ii)[s(:,ii);1]' * cl.model_weights(:,3) >= 0,201:300));
            assert(cl.reg_param == 1);
            assert(cl.num_threads == 3);
            assert(tc.same(cl.input_geometry,2));
            assert(tc.same(cl.saved_labels,{'1' '2' '3'}));
            assert(cl.saved_labels_count == 3);
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 300\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized L2-loss support vector classification in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 3\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 600\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '      Worker 01:\n',...
                                                          '        2-vs-All\n',...
                                                          '      Worker 02:\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n'))));
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('  Function "classify".\n');
            
            fprintf('    On clearly separated data.\n');
            
            fprintf('      With L1 regularized logistic regression in primal form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_clear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.logistic_primal_regL1,1,1,log);
            [labels_idx_hat,labels_confidence,score,conf_matrix,misclassified] = cl.classify(s_ts,ci_ts,log);
            
            assert(tc.same(labels_idx_hat,ci_ts.labels_idx));
            assert(tc.matrix(labels_confidence));
            assert(tc.same(size(labels_confidence),[3 60]));
            assert(tc.unitreal(labels_confidence));
            assert(tc.same(labels_confidence(1,1:20),ones(1,20)));
            assert(tc.same(labels_confidence(2,21:40),ones(1,20)));
            assert(tc.same(labels_confidence(3,41:60),ones(1,20)));
            assert(score == 100);
            assert(tc.check(conf_matrix == [20 0 0; 0 20 0; 0 0 20]));
            assert(tc.empty(misclassified));
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L1-regularized logistic regression in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n',...
                                                          'Classifying with each classifier:\n',...
                                                          '  Classification via "liblinear":\n',...
                                                          '    Configuration:\n',...
                                                          '      Sample Count: 60\n',...
                                                          '      Sample Geometry: 2\n',...
                                                          '      Classifiers Count: 3\n',...
                                                          '      Method: L1-regularized logistic regression in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '    Classifying sample:\n',...
                                                          '      Instance 1 to 6.\n',...
                                                          '      Instance 7 to 12.\n',...
                                                          '      Instance 13 to 18.\n',...
                                                          '      Instance 19 to 24.\n',...
                                                          '      Instance 25 to 30.\n',...
                                                          '      Instance 31 to 36.\n',...
                                                          '      Instance 37 to 42.\n',...
                                                          '      Instance 43 to 48.\n',...
                                                          '      Instance 49 to 54.\n',...
                                                          '      Instance 55 to 60.\n',...
                                                          'Determining most probable class.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('      With L2 regularized logistic regression in primal form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_clear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.logistic_primal_regL2,1,1,log);
            [labels_idx_hat,labels_confidence,score,conf_matrix,misclassified] = cl.classify(s_ts,ci_ts,log);
            
            assert(tc.same(labels_idx_hat,ci_ts.labels_idx));
            assert(tc.matrix(labels_confidence));
            assert(tc.same(size(labels_confidence),[3 60]));
            assert(tc.unitreal(labels_confidence));
            assert(tc.same(labels_confidence(1,1:20),ones(1,20)));
            assert(tc.same(labels_confidence(2,21:40),ones(1,20)));
            assert(tc.same(labels_confidence(3,41:60),ones(1,20)));
            assert(score == 100);
            assert(tc.check(conf_matrix == [20 0 0; 0 20 0; 0 0 20]));
            assert(tc.empty(misclassified));
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized logistic regression in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n',...
                                                          'Classifying with each classifier:\n',...
                                                          '  Classification via "liblinear":\n',...
                                                          '    Configuration:\n',...
                                                          '      Sample Count: 60\n',...
                                                          '      Sample Geometry: 2\n',...
                                                          '      Classifiers Count: 3\n',...
                                                          '      Method: L2-regularized logistic regression in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '    Classifying sample:\n',...
                                                          '      Instance 1 to 6.\n',...
                                                          '      Instance 7 to 12.\n',...
                                                          '      Instance 13 to 18.\n',...
                                                          '      Instance 19 to 24.\n',...
                                                          '      Instance 25 to 30.\n',...
                                                          '      Instance 31 to 36.\n',...
                                                          '      Instance 37 to 42.\n',...
                                                          '      Instance 43 to 48.\n',...
                                                          '      Instance 49 to 54.\n',...
                                                          '      Instance 55 to 60.\n',...
                                                          'Determining most probable class.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('      With L2 regularized logistic regression in dual form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_clear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.logistic_dual_regL2,1,1,log);
            [labels_idx_hat,labels_confidence,score,conf_matrix,misclassified] = cl.classify(s_ts,ci_ts,log);
            
            assert(tc.same(labels_idx_hat,ci_ts.labels_idx));
            assert(tc.matrix(labels_confidence));
            assert(tc.same(size(labels_confidence),[3 60]));
            assert(tc.unitreal(labels_confidence));
            assert(tc.same(labels_confidence(1,1:20),ones(1,20)));
            assert(tc.same(labels_confidence(2,21:40),ones(1,20)));
            assert(tc.same(labels_confidence(3,41:60),ones(1,20)));
            assert(score == 100);
            assert(tc.check(conf_matrix == [20 0 0; 0 20 0; 0 0 20]));
            assert(tc.empty(misclassified));
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized logistic regression in dual form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n',...
                                                          'Classifying with each classifier:\n',...
                                                          '  Classification via "liblinear":\n',...
                                                          '    Configuration:\n',...
                                                          '      Sample Count: 60\n',...
                                                          '      Sample Geometry: 2\n',...
                                                          '      Classifiers Count: 3\n',...
                                                          '      Method: L2-regularized logistic regression in dual form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '    Classifying sample:\n',...
                                                          '      Instance 1 to 6.\n',...
                                                          '      Instance 7 to 12.\n',...
                                                          '      Instance 13 to 18.\n',...
                                                          '      Instance 19 to 24.\n',...
                                                          '      Instance 25 to 30.\n',...
                                                          '      Instance 31 to 36.\n',...
                                                          '      Instance 37 to 42.\n',...
                                                          '      Instance 43 to 48.\n',...
                                                          '      Instance 49 to 54.\n',...
                                                          '      Instance 55 to 60.\n',...
                                                          'Determining most probable class.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('      With L1-regularized L2-loss support vector classification in primal form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_clear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.support_primal_regL1,1,1,log);
            [labels_idx_hat,labels_confidence,score,conf_matrix,misclassified] = cl.classify(s_ts,ci_ts,log);
            
            assert(tc.same(labels_idx_hat,ci_ts.labels_idx));
            assert(tc.matrix(labels_confidence));
            assert(tc.same(size(labels_confidence),[3 60]));
            assert(tc.unitreal(labels_confidence));
            assert(tc.same(labels_confidence(1,1:20),ones(1,20)));
            assert(tc.same(labels_confidence(2,21:40),ones(1,20)));
            assert(tc.same(labels_confidence(3,41:60),ones(1,20)));
            assert(score == 100);
            assert(tc.check(conf_matrix == [20 0 0; 0 20 0; 0 0 20]));
            assert(tc.empty(misclassified));
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L1-regularized L2-loss support vector classification in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n',...
                                                          'Classifying with each classifier:\n',...
                                                          '  Classification via "liblinear":\n',...
                                                          '    Configuration:\n',...
                                                          '      Sample Count: 60\n',...
                                                          '      Sample Geometry: 2\n',...
                                                          '      Classifiers Count: 3\n',...
                                                          '      Method: L1-regularized L2-loss support vector classification in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '    Classifying sample:\n',...
                                                          '      Instance 1 to 6.\n',...
                                                          '      Instance 7 to 12.\n',...
                                                          '      Instance 13 to 18.\n',...
                                                          '      Instance 19 to 24.\n',...
                                                          '      Instance 25 to 30.\n',...
                                                          '      Instance 31 to 36.\n',...
                                                          '      Instance 37 to 42.\n',...
                                                          '      Instance 43 to 48.\n',...
                                                          '      Instance 49 to 54.\n',...
                                                          '      Instance 55 to 60.\n',...
                                                          'Determining most probable class.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('      With L1-regularized L2-loss support vector classification in primal form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_clear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.support_primal_regL2,1,1,log);
            [labels_idx_hat,labels_confidence,score,conf_matrix,misclassified] = cl.classify(s_ts,ci_ts,log);
            
            assert(tc.same(labels_idx_hat,ci_ts.labels_idx));
            assert(tc.matrix(labels_confidence));
            assert(tc.same(size(labels_confidence),[3 60]));
            assert(tc.unitreal(labels_confidence));
            assert(tc.same(labels_confidence(1,1:20),ones(1,20)));
            assert(tc.same(labels_confidence(2,21:40),ones(1,20)));
            assert(tc.same(labels_confidence(3,41:60),ones(1,20)));
            assert(score == 100);
            assert(tc.check(conf_matrix == [20 0 0; 0 20 0; 0 0 20]));
            assert(tc.empty(misclassified));
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized L2-loss support vector classification in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n',...
                                                          'Classifying with each classifier:\n',...
                                                          '  Classification via "liblinear":\n',...
                                                          '    Configuration:\n',...
                                                          '      Sample Count: 60\n',...
                                                          '      Sample Geometry: 2\n',...
                                                          '      Classifiers Count: 3\n',...
                                                          '      Method: L2-regularized L2-loss support vector classification in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '    Classifying sample:\n',...
                                                          '      Instance 1 to 6.\n',...
                                                          '      Instance 7 to 12.\n',...
                                                          '      Instance 13 to 18.\n',...
                                                          '      Instance 19 to 24.\n',...
                                                          '      Instance 25 to 30.\n',...
                                                          '      Instance 31 to 36.\n',...
                                                          '      Instance 37 to 42.\n',...
                                                          '      Instance 43 to 48.\n',...
                                                          '      Instance 49 to 54.\n',...
                                                          '      Instance 55 to 60.\n',...
                                                          'Determining most probable class.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('      With L2-regularized L1-loss support vector classification in dual form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_clear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.support_dual_lossL1,1,1,log);
            [labels_idx_hat,labels_confidence,score,conf_matrix,misclassified] = cl.classify(s_ts,ci_ts,log);
            
            assert(tc.same(labels_idx_hat,ci_ts.labels_idx));
            assert(tc.matrix(labels_confidence));
            assert(tc.same(size(labels_confidence),[3 60]));
            assert(tc.unitreal(labels_confidence));
            assert(tc.same(labels_confidence(1,1:20),ones(1,20)));
            assert(tc.same(labels_confidence(2,21:40),ones(1,20)));
            assert(tc.same(labels_confidence(3,41:60),ones(1,20)));
            assert(score == 100);
            assert(tc.check(conf_matrix == [20 0 0; 0 20 0; 0 0 20]));
            assert(tc.empty(misclassified));
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized L1-loss support vector classification in dual form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n',...
                                                          'Classifying with each classifier:\n',...
                                                          '  Classification via "liblinear":\n',...
                                                          '    Configuration:\n',...
                                                          '      Sample Count: 60\n',...
                                                          '      Sample Geometry: 2\n',...
                                                          '      Classifiers Count: 3\n',...
                                                          '      Method: L2-regularized L1-loss support vector classification in dual form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '    Classifying sample:\n',...
                                                          '      Instance 1 to 6.\n',...
                                                          '      Instance 7 to 12.\n',...
                                                          '      Instance 13 to 18.\n',...
                                                          '      Instance 19 to 24.\n',...
                                                          '      Instance 25 to 30.\n',...
                                                          '      Instance 31 to 36.\n',...
                                                          '      Instance 37 to 42.\n',...
                                                          '      Instance 43 to 48.\n',...
                                                          '      Instance 49 to 54.\n',...
                                                          '      Instance 55 to 60.\n',...
                                                          'Determining most probable class.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('      With L2-regularized L2-loss support vector classification in dual form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_clear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.support_dual_lossL2,1,1,log);
            [labels_idx_hat,labels_confidence,score,conf_matrix,misclassified] = cl.classify(s_ts,ci_ts,log);
            
            assert(tc.same(labels_idx_hat,ci_ts.labels_idx));
            assert(tc.matrix(labels_confidence));
            assert(tc.same(size(labels_confidence),[3 60]));
            assert(tc.unitreal(labels_confidence));
            assert(tc.same(labels_confidence(1,1:20),ones(1,20)));
            assert(tc.same(labels_confidence(2,21:40),ones(1,20)));
            assert(tc.same(labels_confidence(3,41:60),ones(1,20)));
            assert(score == 100);
            assert(tc.check(conf_matrix == [20 0 0; 0 20 0; 0 0 20]));
            assert(tc.empty(misclassified));
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized L2-loss support vector classification in dual form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n',...
                                                          'Classifying with each classifier:\n',...
                                                          '  Classification via "liblinear":\n',...
                                                          '    Configuration:\n',...
                                                          '      Sample Count: 60\n',...
                                                          '      Sample Geometry: 2\n',...
                                                          '      Classifiers Count: 3\n',...
                                                          '      Method: L2-regularized L2-loss support vector classification in dual form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '    Classifying sample:\n',...
                                                          '      Instance 1 to 6.\n',...
                                                          '      Instance 7 to 12.\n',...
                                                          '      Instance 13 to 18.\n',...
                                                          '      Instance 19 to 24.\n',...
                                                          '      Instance 25 to 30.\n',...
                                                          '      Instance 31 to 36.\n',...
                                                          '      Instance 37 to 42.\n',...
                                                          '      Instance 43 to 48.\n',...
                                                          '      Instance 49 to 54.\n',...
                                                          '      Instance 55 to 60.\n',...
                                                          'Determining most probable class.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('      With multiple worker threads.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_clear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.support_primal_regL2,1,3,log);
            [labels_idx_hat,labels_confidence,score,conf_matrix,misclassified] = cl.classify(s_ts,ci_ts,log);
            
            assert(tc.same(labels_idx_hat,ci_ts.labels_idx));
            assert(tc.matrix(labels_confidence));
            assert(tc.same(size(labels_confidence),[3 60]));
            assert(tc.unitreal(labels_confidence));
            assert(tc.same(labels_confidence(1,1:20),ones(1,20)));
            assert(tc.same(labels_confidence(2,21:40),ones(1,20)));
            assert(tc.same(labels_confidence(3,41:60),ones(1,20)));
            assert(score == 100);
            assert(tc.check(conf_matrix == [20 0 0; 0 20 0; 0 0 20]));
            assert(tc.empty(misclassified));
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized L2-loss support vector classification in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 3\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '      Worker 01:\n',...
                                                          '        2-vs-All\n',...
                                                          '      Worker 02:\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n',...
                                                          'Classifying with each classifier:\n',...
                                                          '  Classification via "liblinear":\n',...
                                                          '    Configuration:\n',...
                                                          '      Sample Count: 60\n',...
                                                          '      Sample Geometry: 2\n',...
                                                          '      Classifiers Count: 3\n',...
                                                          '      Method: L2-regularized L2-loss support vector classification in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '    Classifying sample:\n',...
                                                          '      Instance 1 to 6.\n',...
                                                          '      Instance 7 to 12.\n',...
                                                          '      Instance 13 to 18.\n',...
                                                          '      Instance 19 to 24.\n',...
                                                          '      Instance 25 to 30.\n',...
                                                          '      Instance 31 to 36.\n',...
                                                          '      Instance 37 to 42.\n',...
                                                          '      Instance 43 to 48.\n',...
                                                          '      Instance 49 to 54.\n',...
                                                          '      Instance 55 to 60.\n',...
                                                          'Determining most probable class.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('    On mostly separated data.\n');
            
            fprintf('      With L1 regularized logistic regression in primal form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_mostly_clear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.logistic_primal_regL1,1,1,log);
            [labels_idx_hat,labels_confidence,score,conf_matrix,misclassified] = cl.classify(s_ts,ci_ts,log);
            
            assert(tc.same(labels_idx_hat(1:18),ci_ts.labels_idx(1:18)));
            assert(tc.same(labels_idx_hat(21:38),ci_ts.labels_idx(21:38)));
            assert(tc.same(labels_idx_hat(41:58),ci_ts.labels_idx(41:58)));
            assert(labels_idx_hat(19) == 2);
            assert(labels_idx_hat(20) == 3);
            assert(labels_idx_hat(39) == 1);
            assert(labels_idx_hat(40) == 3);
            assert(labels_idx_hat(59) == 1);
            assert(labels_idx_hat(60) == 2);
            assert(tc.same(labels_confidence(1,1:18),ones(1,18)));
            assert(tc.same(labels_confidence(2,19),1));
            assert(tc.same(labels_confidence(3,20),1));
            assert(tc.same(labels_confidence(2,21:38),ones(1,18)));
            assert(tc.same(labels_confidence(1,39),1));
            assert(tc.same(labels_confidence(3,40),1));
            assert(tc.same(labels_confidence(3,41:58),ones(1,18)));
            assert(tc.same(labels_confidence(1,59),1));
            assert(tc.same(labels_confidence(2,60),1));
            assert(score == 90);
            assert(tc.same(conf_matrix,[18 1 1; 1 18 1; 1 1 18]));
            assert(tc.same(misclassified,[19 20 39 40 59 60]));
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L1-regularized logistic regression in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n',...
                                                          'Classifying with each classifier:\n',...
                                                          '  Classification via "liblinear":\n',...
                                                          '    Configuration:\n',...
                                                          '      Sample Count: 60\n',...
                                                          '      Sample Geometry: 2\n',...
                                                          '      Classifiers Count: 3\n',...
                                                          '      Method: L1-regularized logistic regression in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '    Classifying sample:\n',...
                                                          '      Instance 1 to 6.\n',...
                                                          '      Instance 7 to 12.\n',...
                                                          '      Instance 13 to 18.\n',...
                                                          '      Instance 19 to 24.\n',...
                                                          '      Instance 25 to 30.\n',...
                                                          '      Instance 31 to 36.\n',...
                                                          '      Instance 37 to 42.\n',...
                                                          '      Instance 43 to 48.\n',...
                                                          '      Instance 49 to 54.\n',...
                                                          '      Instance 55 to 60.\n',...
                                                          'Determining most probable class.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('      With L2 regularized logistic regression in primal form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_mostly_clear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.logistic_primal_regL2,1,1,log);
            [labels_idx_hat,labels_confidence,score,conf_matrix,misclassified] = cl.classify(s_ts,ci_ts,log);
            
            assert(tc.same(labels_idx_hat(1:18),ci_ts.labels_idx(1:18)));
            assert(tc.same(labels_idx_hat(21:38),ci_ts.labels_idx(21:38)));
            assert(tc.same(labels_idx_hat(41:58),ci_ts.labels_idx(41:58)));
            assert(labels_idx_hat(19) == 2);
            assert(labels_idx_hat(20) == 3);
            assert(labels_idx_hat(39) == 1);
            assert(labels_idx_hat(40) == 3);
            assert(labels_idx_hat(59) == 1);
            assert(labels_idx_hat(60) == 2);
            assert(tc.same(labels_confidence(1,1:18),ones(1,18)));
            assert(tc.same(labels_confidence(2,19),1));
            assert(tc.same(labels_confidence(3,20),1));
            assert(tc.same(labels_confidence(2,21:38),ones(1,18)));
            assert(tc.same(labels_confidence(1,39),1));
            assert(tc.same(labels_confidence(3,40),1));
            assert(tc.same(labels_confidence(3,41:58),ones(1,18)));
            assert(tc.same(labels_confidence(1,59),1));
            assert(tc.same(labels_confidence(2,60),1));
            assert(score == 90);
            assert(tc.same(conf_matrix,[18 1 1; 1 18 1; 1 1 18]));
            assert(tc.same(misclassified,[19 20 39 40 59 60]));
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized logistic regression in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n',...
                                                          'Classifying with each classifier:\n',...
                                                          '  Classification via "liblinear":\n',...
                                                          '    Configuration:\n',...
                                                          '      Sample Count: 60\n',...
                                                          '      Sample Geometry: 2\n',...
                                                          '      Classifiers Count: 3\n',...
                                                          '      Method: L2-regularized logistic regression in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '    Classifying sample:\n',...
                                                          '      Instance 1 to 6.\n',...
                                                          '      Instance 7 to 12.\n',...
                                                          '      Instance 13 to 18.\n',...
                                                          '      Instance 19 to 24.\n',...
                                                          '      Instance 25 to 30.\n',...
                                                          '      Instance 31 to 36.\n',...
                                                          '      Instance 37 to 42.\n',...
                                                          '      Instance 43 to 48.\n',...
                                                          '      Instance 49 to 54.\n',...
                                                          '      Instance 55 to 60.\n',...
                                                          'Determining most probable class.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('      With L2 regularized logistic regression in dual form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_mostly_clear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.logistic_dual_regL2,1,1,log);
            [labels_idx_hat,labels_confidence,score,conf_matrix,misclassified] = cl.classify(s_ts,ci_ts,log);
            
            assert(tc.same(labels_idx_hat(1:18),ci_ts.labels_idx(1:18)));
            assert(tc.same(labels_idx_hat(21:38),ci_ts.labels_idx(21:38)));
            assert(tc.same(labels_idx_hat(41:58),ci_ts.labels_idx(41:58)));
            assert(labels_idx_hat(19) == 2);
            assert(labels_idx_hat(20) == 3);
            assert(labels_idx_hat(39) == 1);
            assert(labels_idx_hat(40) == 3);
            assert(labels_idx_hat(59) == 1);
            assert(labels_idx_hat(60) == 2);
            assert(tc.same(labels_confidence(1,1:18),ones(1,18)));
            assert(tc.same(labels_confidence(2,19),1));
            assert(tc.same(labels_confidence(3,20),1));
            assert(tc.same(labels_confidence(2,21:38),ones(1,18)));
            assert(tc.same(labels_confidence(1,39),1));
            assert(tc.same(labels_confidence(3,40),1));
            assert(tc.same(labels_confidence(3,41:58),ones(1,18)));
            assert(tc.same(labels_confidence(1,59),1));
            assert(tc.same(labels_confidence(2,60),1));
            assert(score == 90);
            assert(tc.same(conf_matrix,[18 1 1; 1 18 1; 1 1 18]));
            assert(tc.same(misclassified,[19 20 39 40 59 60]));
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized logistic regression in dual form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n',...
                                                          'Classifying with each classifier:\n',...
                                                          '  Classification via "liblinear":\n',...
                                                          '    Configuration:\n',...
                                                          '      Sample Count: 60\n',...
                                                          '      Sample Geometry: 2\n',...
                                                          '      Classifiers Count: 3\n',...
                                                          '      Method: L2-regularized logistic regression in dual form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '    Classifying sample:\n',...
                                                          '      Instance 1 to 6.\n',...
                                                          '      Instance 7 to 12.\n',...
                                                          '      Instance 13 to 18.\n',...
                                                          '      Instance 19 to 24.\n',...
                                                          '      Instance 25 to 30.\n',...
                                                          '      Instance 31 to 36.\n',...
                                                          '      Instance 37 to 42.\n',...
                                                          '      Instance 43 to 48.\n',...
                                                          '      Instance 49 to 54.\n',...
                                                          '      Instance 55 to 60.\n',...
                                                          'Determining most probable class.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('      With L1-regularized L2-loss support vector classification in primal form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_mostly_clear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.support_primal_regL1,1,1,log);
            [labels_idx_hat,labels_confidence,score,conf_matrix,misclassified] = cl.classify(s_ts,ci_ts,log);
            
            assert(tc.same(labels_idx_hat(1:18),ci_ts.labels_idx(1:18)));
            assert(tc.same(labels_idx_hat(21:38),ci_ts.labels_idx(21:38)));
            assert(tc.same(labels_idx_hat(41:58),ci_ts.labels_idx(41:58)));
            assert(labels_idx_hat(19) == 2);
            assert(labels_idx_hat(20) == 3);
            assert(labels_idx_hat(39) == 1);
            assert(labels_idx_hat(40) == 3);
            assert(labels_idx_hat(59) == 1);
            assert(labels_idx_hat(60) == 2);
            assert(tc.same(labels_confidence(1,1:18),ones(1,18)));
            assert(tc.same(labels_confidence(2,19),1));
            assert(tc.same(labels_confidence(3,20),1));
            assert(tc.same(labels_confidence(2,21:38),ones(1,18)));
            assert(tc.same(labels_confidence(1,39),1));
            assert(tc.same(labels_confidence(3,40),1));
            assert(tc.same(labels_confidence(3,41:58),ones(1,18)));
            assert(tc.same(labels_confidence(1,59),1));
            assert(tc.same(labels_confidence(2,60),1));
            assert(score == 90);
            assert(tc.same(conf_matrix,[18 1 1; 1 18 1; 1 1 18]));
            assert(tc.same(misclassified,[19 20 39 40 59 60]));
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L1-regularized L2-loss support vector classification in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n',...
                                                          'Classifying with each classifier:\n',...
                                                          '  Classification via "liblinear":\n',...
                                                          '    Configuration:\n',...
                                                          '      Sample Count: 60\n',...
                                                          '      Sample Geometry: 2\n',...
                                                          '      Classifiers Count: 3\n',...
                                                          '      Method: L1-regularized L2-loss support vector classification in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '    Classifying sample:\n',...
                                                          '      Instance 1 to 6.\n',...
                                                          '      Instance 7 to 12.\n',...
                                                          '      Instance 13 to 18.\n',...
                                                          '      Instance 19 to 24.\n',...
                                                          '      Instance 25 to 30.\n',...
                                                          '      Instance 31 to 36.\n',...
                                                          '      Instance 37 to 42.\n',...
                                                          '      Instance 43 to 48.\n',...
                                                          '      Instance 49 to 54.\n',...
                                                          '      Instance 55 to 60.\n',...
                                                          'Determining most probable class.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('      With L1-regularized L2-loss support vector classification in primal form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_mostly_clear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.support_primal_regL2,1,1,log);
            [labels_idx_hat,labels_confidence,score,conf_matrix,misclassified] = cl.classify(s_ts,ci_ts,log);
            
            assert(tc.same(labels_idx_hat(1:18),ci_ts.labels_idx(1:18)));
            assert(tc.same(labels_idx_hat(21:38),ci_ts.labels_idx(21:38)));
            assert(tc.same(labels_idx_hat(41:58),ci_ts.labels_idx(41:58)));
            assert(labels_idx_hat(19) == 2);
            assert(labels_idx_hat(20) == 3);
            assert(labels_idx_hat(39) == 1);
            assert(labels_idx_hat(40) == 3);
            assert(labels_idx_hat(59) == 1);
            assert(labels_idx_hat(60) == 2);
            assert(tc.same(labels_confidence(1,1:18),ones(1,18)));
            assert(tc.same(labels_confidence(2,19),1));
            assert(tc.same(labels_confidence(3,20),1));
            assert(tc.same(labels_confidence(2,21:38),ones(1,18)));
            assert(tc.same(labels_confidence(1,39),1));
            assert(tc.same(labels_confidence(3,40),1));
            assert(tc.same(labels_confidence(3,41:58),ones(1,18)));
            assert(tc.same(labels_confidence(1,59),1));
            assert(tc.same(labels_confidence(2,60),1));
            assert(score == 90);
            assert(tc.same(conf_matrix,[18 1 1; 1 18 1; 1 1 18]));
            assert(tc.same(misclassified,[19 20 39 40 59 60]));
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized L2-loss support vector classification in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n',...
                                                          'Classifying with each classifier:\n',...
                                                          '  Classification via "liblinear":\n',...
                                                          '    Configuration:\n',...
                                                          '      Sample Count: 60\n',...
                                                          '      Sample Geometry: 2\n',...
                                                          '      Classifiers Count: 3\n',...
                                                          '      Method: L2-regularized L2-loss support vector classification in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '    Classifying sample:\n',...
                                                          '      Instance 1 to 6.\n',...
                                                          '      Instance 7 to 12.\n',...
                                                          '      Instance 13 to 18.\n',...
                                                          '      Instance 19 to 24.\n',...
                                                          '      Instance 25 to 30.\n',...
                                                          '      Instance 31 to 36.\n',...
                                                          '      Instance 37 to 42.\n',...
                                                          '      Instance 43 to 48.\n',...
                                                          '      Instance 49 to 54.\n',...
                                                          '      Instance 55 to 60.\n',...
                                                          'Determining most probable class.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('      With L2-regularized L1-loss support vector classification in dual form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_mostly_clear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.support_dual_lossL1,1,1,log);
            [labels_idx_hat,labels_confidence,score,conf_matrix,misclassified] = cl.classify(s_ts,ci_ts,log);
            
            assert(tc.same(labels_idx_hat(1:18),ci_ts.labels_idx(1:18)));
            assert(tc.same(labels_idx_hat(21:38),ci_ts.labels_idx(21:38)));
            assert(tc.same(labels_idx_hat(41:58),ci_ts.labels_idx(41:58)));
            assert(labels_idx_hat(19) == 2);
            assert(labels_idx_hat(20) == 3);
            assert(labels_idx_hat(39) == 1);
            assert(labels_idx_hat(40) == 3);
            assert(labels_idx_hat(59) == 1);
            assert(labels_idx_hat(60) == 2);
            assert(tc.same(labels_confidence(1,1:18),ones(1,18)));
            assert(tc.same(labels_confidence(2,19),1));
            assert(tc.same(labels_confidence(3,20),1));
            assert(tc.same(labels_confidence(2,21:38),ones(1,18)));
            assert(tc.same(labels_confidence(1,39),1));
            assert(tc.same(labels_confidence(3,40),1));
            assert(tc.same(labels_confidence(3,41:58),ones(1,18)));
            assert(tc.same(labels_confidence(1,59),1));
            assert(tc.same(labels_confidence(2,60),1));
            assert(score == 90);
            assert(tc.same(conf_matrix,[18 1 1; 1 18 1; 1 1 18]));
            assert(tc.same(misclassified,[19 20 39 40 59 60]));
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized L1-loss support vector classification in dual form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n',...
                                                          'Classifying with each classifier:\n',...
                                                          '  Classification via "liblinear":\n',...
                                                          '    Configuration:\n',...
                                                          '      Sample Count: 60\n',...
                                                          '      Sample Geometry: 2\n',...
                                                          '      Classifiers Count: 3\n',...
                                                          '      Method: L2-regularized L1-loss support vector classification in dual form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '    Classifying sample:\n',...
                                                          '      Instance 1 to 6.\n',...
                                                          '      Instance 7 to 12.\n',...
                                                          '      Instance 13 to 18.\n',...
                                                          '      Instance 19 to 24.\n',...
                                                          '      Instance 25 to 30.\n',...
                                                          '      Instance 31 to 36.\n',...
                                                          '      Instance 37 to 42.\n',...
                                                          '      Instance 43 to 48.\n',...
                                                          '      Instance 49 to 54.\n',...
                                                          '      Instance 55 to 60.\n',...
                                                          'Determining most probable class.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('      With L2-regularized L2-loss support vector classification in dual form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_mostly_clear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.support_dual_lossL2,1,1,log);
            [labels_idx_hat,labels_confidence,score,conf_matrix,misclassified] = cl.classify(s_ts,ci_ts,log);
            
            assert(tc.same(labels_idx_hat(1:18),ci_ts.labels_idx(1:18)));
            assert(tc.same(labels_idx_hat(21:38),ci_ts.labels_idx(21:38)));
            assert(tc.same(labels_idx_hat(41:58),ci_ts.labels_idx(41:58)));
            assert(labels_idx_hat(19) == 2);
            assert(labels_idx_hat(20) == 3);
            assert(labels_idx_hat(39) == 1);
            assert(labels_idx_hat(40) == 3);
            assert(labels_idx_hat(59) == 1);
            assert(labels_idx_hat(60) == 2);
            assert(tc.same(labels_confidence(1,1:18),ones(1,18)));
            assert(tc.same(labels_confidence(2,19),1));
            assert(tc.same(labels_confidence(3,20),1));
            assert(tc.same(labels_confidence(2,21:38),ones(1,18)));
            assert(tc.same(labels_confidence(1,39),1));
            assert(tc.same(labels_confidence(3,40),1));
            assert(tc.same(labels_confidence(3,41:58),ones(1,18)));
            assert(tc.same(labels_confidence(1,59),1));
            assert(tc.same(labels_confidence(2,60),1));
            assert(score == 90);
            assert(tc.same(conf_matrix,[18 1 1; 1 18 1; 1 1 18]));
            assert(tc.same(misclassified,[19 20 39 40 59 60]));
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized L2-loss support vector classification in dual form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n',...
                                                          'Classifying with each classifier:\n',...
                                                          '  Classification via "liblinear":\n',...
                                                          '    Configuration:\n',...
                                                          '      Sample Count: 60\n',...
                                                          '      Sample Geometry: 2\n',...
                                                          '      Classifiers Count: 3\n',...
                                                          '      Method: L2-regularized L2-loss support vector classification in dual form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '    Classifying sample:\n',...
                                                          '      Instance 1 to 6.\n',...
                                                          '      Instance 7 to 12.\n',...
                                                          '      Instance 13 to 18.\n',...
                                                          '      Instance 19 to 24.\n',...
                                                          '      Instance 25 to 30.\n',...
                                                          '      Instance 31 to 36.\n',...
                                                          '      Instance 37 to 42.\n',...
                                                          '      Instance 43 to 48.\n',...
                                                          '      Instance 49 to 54.\n',...
                                                          '      Instance 55 to 60.\n',...
                                                          'Determining most probable class.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('      With multiple worker threads.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_mostly_clear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.support_primal_regL2,1,3,log);
            [labels_idx_hat,labels_confidence,score,conf_matrix,misclassified] = cl.classify(s_ts,ci_ts,log);
            
            assert(tc.same(labels_idx_hat(1:18),ci_ts.labels_idx(1:18)));
            assert(tc.same(labels_idx_hat(21:38),ci_ts.labels_idx(21:38)));
            assert(tc.same(labels_idx_hat(41:58),ci_ts.labels_idx(41:58)));
            assert(labels_idx_hat(19) == 2);
            assert(labels_idx_hat(20) == 3);
            assert(labels_idx_hat(39) == 1);
            assert(labels_idx_hat(40) == 3);
            assert(labels_idx_hat(59) == 1);
            assert(labels_idx_hat(60) == 2);
            assert(tc.same(labels_confidence(1,1:18),ones(1,18)));
            assert(tc.same(labels_confidence(2,19),1));
            assert(tc.same(labels_confidence(3,20),1));
            assert(tc.same(labels_confidence(2,21:38),ones(1,18)));
            assert(tc.same(labels_confidence(1,39),1));
            assert(tc.same(labels_confidence(3,40),1));
            assert(tc.same(labels_confidence(3,41:58),ones(1,18)));
            assert(tc.same(labels_confidence(1,59),1));
            assert(tc.same(labels_confidence(2,60),1));
            assert(score == 90);
            assert(tc.same(conf_matrix,[18 1 1; 1 18 1; 1 1 18]));
            assert(tc.same(misclassified,[19 20 39 40 59 60]));
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized L2-loss support vector classification in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 3\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '      Worker 01:\n',...
                                                          '        2-vs-All\n',...
                                                          '      Worker 02:\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n',...
                                                          'Classifying with each classifier:\n',...
                                                          '  Classification via "liblinear":\n',...
                                                          '    Configuration:\n',...
                                                          '      Sample Count: 60\n',...
                                                          '      Sample Geometry: 2\n',...
                                                          '      Classifiers Count: 3\n',...
                                                          '      Method: L2-regularized L2-loss support vector classification in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '    Classifying sample:\n',...
                                                          '      Instance 1 to 6.\n',...
                                                          '      Instance 7 to 12.\n',...
                                                          '      Instance 13 to 18.\n',...
                                                          '      Instance 19 to 24.\n',...
                                                          '      Instance 25 to 30.\n',...
                                                          '      Instance 31 to 36.\n',...
                                                          '      Instance 37 to 42.\n',...
                                                          '      Instance 43 to 48.\n',...
                                                          '      Instance 49 to 54.\n',...
                                                          '      Instance 55 to 60.\n',...
                                                          'Determining most probable class.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('    On not so clearly separated data.\n');
            
            fprintf('      With L1 regularized logistic regression in primal form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_unclear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.logistic_primal_regL1,1,1,log);
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L1-regularized logistic regression in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('      With L2 regularized logistic regression in primal form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_unclear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.logistic_primal_regL2,1,1,log);
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized logistic regression in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('      With L2 regularized logistic regression in dual form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_unclear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.logistic_dual_regL2,1,1,log);
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized logistic regression in dual form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('      With L1-regularized L2-loss support vector classification in primal form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_unclear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.support_primal_regL1,1,1,log);
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L1-regularized L2-loss support vector classification in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('      With L1-regularized L2-loss support vector classification in primal form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_unclear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.support_primal_regL2,1,1,log);
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized L2-loss support vector classification in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('      With L2-regularized L1-loss support vector classification in dual form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_unclear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.support_dual_lossL1,1,1,log);
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized L1-loss support vector classification in dual form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('      With L2-regularized L2-loss support vector classification in dual form.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_unclear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.support_dual_lossL2,1,1,log);
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized L2-loss support vector classification in dual form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 1\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '        2-vs-All\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
            
            fprintf('      With multiple worker threads.\n');
            
            hnd = logging.handlers.testing(logging.level.All);
            log = logging.logger({hnd});
            
            [s_tr,s_ts,ci_tr,ci_ts] = utilstest.classifier_unclear_data_3();
            
            cl = classifiers.liblinear.one_vs_all(s_tr,ci_tr,@classifiers.liblinear.one_vs_all.support_primal_regL2,1,3,log);
            
            assert(tc.same(hnd.logged_data,sprintf(strcat('Training each classifier:\n',...
                                                          '  Parallel training via "liblinear" in One-vs-All fashion:\n',...
                                                          '    Configuration:\n',...
                                                          '      Train Sample Count: 240\n',...
                                                          '      Train Sample Geometry: 2\n',...
                                                          '      Classes Count: 3\n',...
                                                          '      Method: L2-regularized L2-loss support vector classification in primal form\n',...
                                                          '      Regularization Parameter: 1.000000\n',...
                                                          '      Number of Worker Threads: 3\n',...
                                                          '      Average Number of Non-Null Entries: 2\n',...
                                                          '      Total Number of Non-Null Entries: 480\n',...
                                                          '    Building problem info and copying sample to "liblinear" format.\n',...
                                                          '    Building parameters info.\n',...
                                                          '    Checking parameters info.\n',...
                                                          '    Building worker task allocation.\n',...
                                                          '    Worker task allocation:\n',...
                                                          '      Worker 00:\n',...
                                                          '        1-vs-All\n',...
                                                          '      Worker 01:\n',...
                                                          '        2-vs-All\n',...
                                                          '      Worker 02:\n',...
                                                          '        3-vs-All\n',...
                                                          '    Starting parallel training of classifiers.\n',...
                                                          '    Finished parallel training of classifiers.\n'))));
                                                      
            if exist('display','var') && (display == true)
                utilstest.show_classification_border(cl,s_tr,s_ts,ci_tr,ci_ts,[-1 5 -1 5]);
            end
            
            log.close();
            hnd.close();
            
            clearvars -except display;
        end
    end
end
